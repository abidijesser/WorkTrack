import{r as a,x as S,u as R,j as e,C as L,a as k,b as A,c as B,d as F,e as q,A as f,f as w,D as j,i as D,B as G}from"./index-D6BHh2cn.js";import{C as T}from"./CCardGroup-BZjGkYKK.js";const M=()=>{const[t,v]=a.useState(""),[n,g]=a.useState(""),[l,c]=a.useState(""),[u,o]=a.useState(""),[m,d]=a.useState(""),[p,h]=a.useState(""),{token:P}=S(),N=R(),x=r=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/.test(r),b=r=>{const s=r.target.value;v(s),x(s)?c(""):c("Le mot de passe doit contenir au moins 8 caractères, une majuscule, une minuscule et un chiffre"),o(n&&s!==n?"Les mots de passe ne correspondent pas":"")},y=r=>{const s=r.target.value;g(s),o(s!==t?"Les mots de passe ne correspondent pas":"")},E=async r=>{var s,C;if(r.preventDefault(),!x(t)){c("Le mot de passe doit contenir au moins 8 caractères, une majuscule, une minuscule et un chiffre");return}if(t!==n){o("Les mots de passe ne correspondent pas");return}try{const i=await G.post("https://worktrack-server-muu6.onrender.com/api/auth/reset-password",{token:P,newPassword:t});i.data.success?(h("Mot de passe réinitialisé avec succès. Redirection vers la page de connexion..."),d(""),setTimeout(()=>{N("/login")},3e3)):d(i.data.error||"Erreur lors de la réinitialisation du mot de passe")}catch(i){d(((C=(s=i.response)==null?void 0:s.data)==null?void 0:C.error)||"Une erreur est survenue lors de la réinitialisation"),h("")}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(L,{children:e.jsx(k,{className:"justify-content-center",children:e.jsx(A,{md:6,children:e.jsx(T,{children:e.jsx(B,{className:"p-4",children:e.jsx(F,{children:e.jsxs(q,{onSubmit:E,children:[e.jsx("h1",{children:"Réinitialiser le mot de passe"}),m&&e.jsx(f,{color:"danger",children:m}),p&&e.jsx(f,{color:"success",children:p}),e.jsxs("div",{className:"mb-3",children:[e.jsx(w,{type:"password",placeholder:"Nouveau mot de passe",value:t,onChange:b,required:!0}),l&&e.jsx(j,{className:"text-danger",children:l})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(w,{type:"password",placeholder:"Confirmer le mot de passe",value:n,onChange:y,required:!0}),u&&e.jsx(j,{className:"text-danger",children:u})]}),e.jsx(D,{color:"primary",type:"submit",children:"Réinitialiser le mot de passe"})]})})})})})})})})};export{M as default};
